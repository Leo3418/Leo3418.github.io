{{- $seoTitle := false }}
{{- with .Title }}
{{- $seoTitle = printf "%s %s %s"
    (. | markdownify | plainify | htmlUnescape)
    (i18n "punctuationDash" | htmlUnescape)
    $.Site.Title
}}
{{- end }}

{{- $canonicalURL := .Permalink }}

{{- $ogType := cond (or (eq .Kind "page") (eq .Kind "section"))
    "article" "website" }}

{{- $seoDescription := .Description
    | default (printf "%s%s" .Summary (cond .Truncated
        (printf " %s" (i18n "punctuationEllipsis" | htmlUnescape))
        ""
    ))
    | markdownify | plainify | htmlUnescape }}

{{- $header := .Params.header }}
{{- $pageLargeImage := $header.og_image
    | default $header.overlay_image
    | default $header.image }}
{{- $pageTeaserImage := $header.teaser
    | default .Site.Params.og_image
    | default .Site.Params.teaser }}

<title>{{ $seoTitle | default .Site.Title }}</title>
{{- if $seoDescription }}
<meta name="description" content="{{- $seoDescription -}}">
{{- end }}

<meta property="og:type" content="{{ $ogType }}">
<meta property="og:locale" content="{{ replace .Language.Lang "-" "_" }}">
<meta property="og:site_name" content="{{ .Site.Title }}">
<meta property="og:title" content="{{ .Title | default .Site.Title
    | markdownify | plainify | htmlUnescape }}">
<meta property="og:url" content="{{ $canonicalURL }}">
{{- if $pageLargeImage }}
<meta property="og:image" content="{{ absURL $pageLargeImage }}">
{{- else if $pageTeaserImage }}
<meta property="og:image" content="{{ absURL $pageTeaserImage }}">
{{- end }}
